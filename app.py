import streamlit as st
import urllib.parse

# ===========================
# ЁЯЪА WEB APP CONFIGURATION
# ===========================
st.set_page_config(
    page_title="Catalog Admin",
    page_icon="ЁЯУж",
    layout="centered"
)

# ЁЯЧВя╕П р╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕┤р╕Зр╕Бр╣М GitHub Pages
CATALOG_DB = {
    "ЁЯСХ р╣Ар╕кр╕╖р╣Йр╕нр╕Юр╕┤р╕бр╕Юр╣Мр╕ер╕▓р╕вр╕Хр╕▒р╕Фр╣Ар╕вр╣Зр╕Ър╣Гр╕лр╕бр╣И": "https://atbamrungrad-hub.github.io/catalog-app/%E0%B9%80%E0%B8%AA%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%9E%E0%B8%B4%E0%B8%A1%E0%B8%9E%E0%B9%8C%E0%B8%A5%E0%B8%B2%E0%B8%A2%E0%B8%95%E0%B8%B1%E0%B8%94%E0%B9%80%E0%B8%A2%E0%B9%87%E0%B8%9A%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88.html"
}

# --- р╕кр╣Ир╕зр╕Щр╕лр╕▒р╕з (Header) ---
st.title("ЁЯУ▒ р╕гр╕░р╕Ър╕Ър╣Бр╕Кр╕гр╣Мр╣Бр╕Др╕Хр╕Хр╕▓р╕ер╣Зр╕нр╕Бр╣Гр╕лр╣Йр╕ер╕╣р╕Бр╕Др╣Йр╕▓")
st.markdown("р╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕Др╕Хр╕Хр╕▓р╕ер╣Зр╕нр╕Бр╕Фр╣Йр╕▓р╕Щр╕ер╣Ир╕▓р╕З р╣Бр╕ер╣Йр╕зр╕Бр╕Фр╕Ыр╕╕р╣Ир╕бр╣Бр╕Кр╕гр╣Мр╣Ар╕Вр╣Йр╕▓р╣Бр╕Кр╕Ч LINE р╣Др╕Фр╣Йр╕Чр╕▒р╕Щр╕Чр╕╡")
st.divider()

# --- р╕кр╣Ир╕зр╕Щр╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕Др╕Хр╕Хр╕▓р╕ер╣Зр╕нр╕Б ---
st.subheader("1. р╣Ар╕ер╕╖р╕нр╕Бр╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣Ир╕кр╕┤р╕Щр╕Др╣Йр╕▓")
selected_items = []

for name, link in CATALOG_DB.items():
    if st.checkbox(name):
        selected_items.append(f"ЁЯФ╣ {name}\nЁЯФЧ {link}")

st.divider()

# --- р╕кр╣Ир╕зр╕Щр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Ар╕Кр╕╡р╕вр╕гр╣Мр╕Вр╕▓р╕в ---
st.subheader("2. р╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б")
caption = st.text_area(
    "р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Щр╕│р╣Ар╕кр╕Щр╕н (р╣Бр╕Бр╣Йр╣Др╕Вр╣Др╕Фр╣Йр╕Хр╕▓р╕бр╕кр╕Цр╕▓р╕Щр╕Бр╕▓р╕гр╕Ур╣М):", 
    "р╕кр╕зр╕▒р╕кр╕Фр╕╡р╕Др╕гр╕▒р╕Ъ ЁЯЩП р╕кр╕Щр╣Гр╕Ир╕Зр╕▓р╕Щр╕кр╕Бр╕гр╕╡р╕Щ/р╕Ыр╕▒р╕Б р╣Бр╕Ър╕Ър╣Др╕лр╕Щ р╕ер╕нр╕Зр╕Др╕ер╕┤р╕Бр╕Фр╕╣р╣Бр╕Др╕Хр╕Хр╕▓р╕ер╣Зр╕нр╕Бр╕Фр╣Йр╕▓р╕Щр╕ер╣Ир╕▓р╕Зр╕Ыр╕гр╕░р╕Бр╕нр╕Ър╕Бр╕▓р╕гр╕Хр╕▒р╕Фр╕кр╕┤р╕Щр╣Гр╕Ир╣Др╕Фр╣Йр╣Ар╕ер╕вр╕Щр╕░р╕Др╕гр╕▒р╕Ъ ЁЯСЗ",
    height=100
)

st.divider()

# --- р╕кр╣Ир╕зр╕Щр╕кр╕гр╕╕р╕Ыр╕Ьр╕ер╣Бр╕ер╕░р╕кр╣Ир╕Зр╣Ар╕Вр╣Йр╕▓ LINE ---
st.subheader("3. р╕Юр╕гр╣Йр╕нр╕бр╕кр╣Ир╕Зр╣Гр╕лр╣Йр╕ер╕╣р╕Бр╕Др╣Йр╕▓ ЁЯЪА")

if selected_items:
    final_message = f"{caption}\n\n" + "\n\n".join(selected_items)
    
    with st.expander("ЁЯСБя╕П р╕Фр╕╣р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Чр╕╡р╣Ир╕Ир╕░р╕кр╣Ир╕З", expanded=False):
        st.code(final_message, language="text")

    encoded_msg = urllib.parse.quote(final_message)
    line_url = f"https://line.me/R/msg/text/?{encoded_msg}"
    
    st.link_button("ЁЯЯв р╣Бр╕Кр╕гр╣Мр╣Ар╕Вр╣Йр╕▓р╣Бр╕нр╕Ы LINE р╕Чр╕▒р╕Щр╕Чр╕╡", line_url, type="primary", use_container_width=True)
else:
    st.info("ЁЯСЖ р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕┤р╣Кр╕Бр╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕Др╕Хр╕Хр╕▓р╕ер╣Зр╕нр╕Бр╕Фр╣Йр╕▓р╕Щр╕Ър╕Щр╕нр╕вр╣Ир╕▓р╕Зр╕Щр╣Йр╕нр╕в 1 р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Бр╣Ир╕нр╕Щр╕Др╕гр╕▒р╕Ъ")
