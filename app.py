import streamlit as st
import urllib.parse

# ===========================
# ğŸš€ WEB APP CONFIGURATION
# ===========================
st.set_page_config(
    page_title="Catalog Admin",
    page_icon="ğŸ“¦",
    layout="centered"
)

# ğŸ—‚ï¸ à¸à¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸¥à¸´à¸‡à¸à¹Œ GitHub Pages
CATALOG_DB = {
    "ğŸ‘• à¹€à¸ªà¸·à¹‰à¸­à¸à¸´à¸¡à¸à¹Œà¸¥à¸²à¸¢à¸•à¸±à¸”à¹€à¸¢à¹‡à¸šà¹ƒà¸«à¸¡à¹ˆ": "https://atbamrungrad-hub.github.io/catalog-app/%E0%B9%80%E0%B8%AA%E0%B8%B7%E0%B9%89%E0%B8%AD%E0%B8%9E%E0%B8%B4%E0%B8%A1%E0%B8%9E%E0%B9%8C%E0%B8%A5%E0%B8%B2%E0%B8%A2%E0%B8%95%E0%B8%B1%E0%B8%94%E0%B9%80%E0%B8%A2%E0%B9%87%E0%B8%9A%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88.html"
}

# --- à¸ªà¹ˆà¸§à¸™à¸«à¸±à¸§ (Header) ---
st.title("ğŸ“± à¸£à¸°à¸šà¸šà¹à¸Šà¸£à¹Œà¹à¸„à¸•à¸•à¸²à¸¥à¹‡à¸­à¸à¹ƒà¸«à¹‰à¸¥à¸¹à¸à¸„à¹‰à¸²")
st.markdown("à¹€à¸¥à¸·à¸­à¸à¹à¸„à¸•à¸•à¸²à¸¥à¹‡à¸­à¸à¸”à¹‰à¸²à¸™à¸¥à¹ˆà¸²à¸‡ à¹à¸¥à¹‰à¸§à¸à¸”à¸›à¸¸à¹ˆà¸¡à¹à¸Šà¸£à¹Œà¹€à¸‚à¹‰à¸²à¹à¸Šà¸— LINE à¹„à¸”à¹‰à¸—à¸±à¸™à¸—à¸µ")
st.divider()

# --- à¸ªà¹ˆà¸§à¸™à¹€à¸¥à¸·à¸­à¸à¹à¸„à¸•à¸•à¸²à¸¥à¹‡à¸­à¸ ---
st.subheader("1. à¹€à¸¥à¸·à¸­à¸à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆà¸ªà¸´à¸™à¸„à¹‰à¸²")
selected_items = []

for name, link in CATALOG_DB.items():
    if st.checkbox(name):
        selected_items.append(f"ğŸ”¹ {name}\nğŸ”— {link}")

st.divider()

# --- à¸ªà¹ˆà¸§à¸™à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹€à¸Šà¸µà¸¢à¸£à¹Œà¸‚à¸²à¸¢ ---
st.subheader("2. à¸›à¸£à¸±à¸šà¹à¸•à¹ˆà¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡")
caption = st.text_area(
    "à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸™à¸³à¹€à¸ªà¸™à¸­ (à¹à¸à¹‰à¹„à¸‚à¹„à¸”à¹‰à¸•à¸²à¸¡à¸ªà¸–à¸²à¸™à¸à¸²à¸£à¸“à¹Œ):", 
    "à¸ªà¸§à¸±à¸ªà¸”à¸µà¸„à¸£à¸±à¸š ğŸ™ à¸ªà¸™à¹ƒà¸ˆà¸‡à¸²à¸™à¸ªà¸à¸£à¸µà¸™/à¸›à¸±à¸ à¹à¸šà¸šà¹„à¸«à¸™ à¸¥à¸­à¸‡à¸„à¸¥à¸´à¸à¸”à¸¹à¹à¸„à¸•à¸•à¸²à¸¥à¹‡à¸­à¸à¸”à¹‰à¸²à¸™à¸¥à¹ˆà¸²à¸‡à¸›à¸£à¸°à¸à¸­à¸šà¸à¸²à¸£à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆà¹„à¸”à¹‰à¹€à¸¥à¸¢à¸™à¸°à¸„à¸£à¸±à¸š ğŸ‘‡",
    height=100
)

st.divider()

# --- à¸ªà¹ˆà¸§à¸™à¸ªà¸£à¸¸à¸›à¸œà¸¥à¹à¸¥à¸°à¸ªà¹ˆà¸‡à¹€à¸‚à¹‰à¸² LINE ---
st.subheader("3. à¸à¸£à¹‰à¸­à¸¡à¸ªà¹ˆà¸‡à¹ƒà¸«à¹‰à¸¥à¸¹à¸à¸„à¹‰à¸² ğŸš€")

if selected_items:
    final_message = f"{caption}\n\n" + "\n\n".join(selected_items)
    
    with st.expander("ğŸ‘ï¸ à¸”à¸¹à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸—à¸µà¹ˆà¸ˆà¸°à¸ªà¹ˆà¸‡", expanded=False):
        st.code(final_message, language="text")

    encoded_msg = urllib.parse.quote(final_message)
    line_url = f"https://line.me/R/msg/text/?{encoded_msg}"
    
    st.link_button("ğŸŸ¢ à¹à¸Šà¸£à¹Œà¹€à¸‚à¹‰à¸²à¹à¸­à¸› LINE à¸—à¸±à¸™à¸—à¸µ", line_url, type="primary", use_container_
